<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>Love Notes - Web</title>
    <style>
        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif;
            background: radial-gradient(circle at top, #FFF7FF 0%, #F3F8FF 40%, #E8F1FF 100%);
            overflow: hidden;
        }

        .app-bg {
            position: fixed;
            inset: 0;
            background: linear-gradient(
                135deg,
                rgba(255, 255, 255, 0.96),
                rgba(249, 237, 255, 0.99)
            );
            z-index: 0;
        }

        .app {
            position: relative;
            width: 100%;
            height: 100%;
            padding: 24px;
            z-index: 1;
        }

        .notes-layer {
            position: relative;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .note {
            position: absolute;
            width: 260px;
            height: 160px;
            border-radius: 16px;
            padding: 0;
            background: transparent;
            box-shadow: none;
            transform: translate3d(0, 24px, 0) scale(0.9) rotate(0deg);
            opacity: 0;
            transition:
                opacity 0.6s ease-out,
                transform 0.9s cubic-bezier(0.19, 1, 0.22, 1),
                left 0.55s ease-in-out,
                top 0.55s ease-in-out;
        }

        .note.visible {
            opacity: 1;
            transform: translate3d(0, 0, 0) scale(1) rotate(var(--note-rotate, -3deg));
        }

        .note-inner {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 16px;
            padding: 10px 14px;
            background: linear-gradient(
                145deg,
                rgba(255, 255, 255, 0.96),
                rgba(255, 249, 255, 0.99)
            );
            box-shadow: 0 10px 24px rgba(148, 123, 187, 0.22);
            border: 1px solid rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(6px);
        }

        .note-title {
            font-size: 11px;
            letter-spacing: 0.16em;
            text-transform: uppercase;
            color: #9c7ac4;
            opacity: 0.9;
        }

        .note-body {
            margin-top: 8px;
            font-size: 16px;
            color: #5e4768;
            line-height: 1.6;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="app-bg"></div>
    <div class="app">
        <div class="notes-layer" id="notes-layer"></div>
    </div>

    <script>
        (function () {
            const NOTE_WIDTH = 260;
            const NOTE_HEIGHT = 160;
            const NOTE_COUNT = 80;
            const CREATE_INTERVAL = 150; // 与 love_notes.py 默认 interval 对齐
            const HEART_DELAY_MS = 250;
            const NOTE_PADDING = 22;

            const COLORS = [
                '#FFEAF4',
                '#F5E9FF',
                '#EAF6FF',
                '#EFFFF6',
                '#FFF5E9',
                '#FDEBFF',
                '#F3F8FF',
                '#FFEFF5',
                '#E9FFF5',
                '#FFF9FF',
            ];

            const MESSAGES = [
                '今天也要元气满满呀',
                '多晒晒太阳多微笑',
                '多喝热水照顾好自己',
                '要记得好好吃饭',
                '偶尔也要休息一下',
                '你真的很了不起',
                '慢慢来一切都会好',
                '给自己一个温柔的拥抱',
                '保持热爱奔赴山海',
                '小确幸正在路上啦',
                '不许熬夜要早睡',
                '早点休息做个好梦',
                '好心情要常在',
                '要对自己温柔一点',
                '相信好事正在发生',
                '愿你所想皆成真',
                '记得抬头看看天空',
                '笑一笑什么都会过去',
                '世界偷偷准备着惊喜',
                '今天也要好好生活',
            ];

            function pickMessages(count) {
                const result = [];
                for (let index = 0; index < count; index += 1) {
                    const message = MESSAGES[Math.floor(Math.random() * MESSAGES.length)];
                    result.push(message);
                }
                return result;
            }

            // 等价于 love_notes.py 的 generate_positions
            function generateScatterPositions(count, width, height) {
                const positions = [];
                if (count <= 0) return positions;

                const cols = Math.max(1, Math.floor(width / (NOTE_WIDTH + 40)));
                const rows = Math.ceil(count / cols);

                const cellWidth = width / cols;
                const cellHeight = height / rows;

                for (let index = 0; index < count; index += 1) {
                    const col = index % cols;
                    const row = Math.floor(index / cols);

                    const jitterX = (cellWidth - NOTE_WIDTH) / 2;
                    const jitterY = (cellHeight - NOTE_HEIGHT) / 2;

                    let x = col * cellWidth + (Math.random() * 2 - 1) * jitterX + jitterX;
                    let y = row * cellHeight + (Math.random() * 2 - 1) * jitterY + jitterY;

                    x = Math.max(NOTE_PADDING, Math.min(x, width - NOTE_WIDTH - NOTE_PADDING));
                    y = Math.max(NOTE_PADDING, Math.min(y, height - NOTE_HEIGHT - NOTE_PADDING));

                    positions.push({ x, y });
                }

                // 打乱顺序
                for (let i = positions.length - 1; i > 0; i -= 1) {
                    const j = Math.floor(Math.random() * (i + 1));
                    const tmp = positions[i];
                    positions[i] = positions[j];
                    positions[j] = tmp;
                }

                return positions;
            }

            // 等价于 love_notes.py 的 generate_heart_positions
            function generateHeartPositions(count, width, height) {
                const positions = [];
                if (count <= 0) return positions;

                const usableWidth = width - 4 * NOTE_PADDING - NOTE_WIDTH;
                const usableHeight = height - 4 * NOTE_PADDING - NOTE_HEIGHT;

                const baseScale = Math.min(usableWidth / 34, usableHeight / 32);
                const clamped = Math.max(14, Math.min(baseScale, 36));

                const scaleX = clamped * 1.22;
                const scaleY = clamped * 0.98;

                const offsetX = width / 2;
                const offsetY = height / 2 - 80;

                for (let index = 0; index < count; index += 1) {
                    const t = (index / count) * Math.PI * 2;

                    const xBase = 16 * Math.sin(t) ** 3;
                    const yBase =
                        13 * Math.cos(t)
                        - 5 * Math.cos(2 * t)
                        - 2 * Math.cos(3 * t)
                        - Math.cos(4 * t);

                    const radial = 0.94 + Math.random() * 0.08;
                    const x = xBase * radial;
                    const y = yBase * radial;

                    const xPos = offsetX + x * scaleX - NOTE_WIDTH / 2;
                    const yPos = offsetY - y * scaleY - NOTE_HEIGHT / 2;

                    positions.push({ x: xPos, y: yPos });
                }

                return positions;
            }

            function createWall() {
                const layer = document.getElementById('notes-layer');
                layer.innerHTML = '';

                const width = window.innerWidth;
                const height = window.innerHeight;

                const messages = pickMessages(NOTE_COUNT);
                const scatterPositions = generateScatterPositions(NOTE_COUNT, width, height);
                const heartPositions = generateHeartPositions(NOTE_COUNT, width, height);

                const notes = [];

                messages.forEach((text, index) => {
                    const delay = index * CREATE_INTERVAL;
                    setTimeout(() => {
                        const noteElement = document.createElement('div');
                        noteElement.className = 'note';
                        noteElement.style.left = `${scatterPositions[index].x}px`;
                        noteElement.style.top = `${scatterPositions[index].y}px`;

                        const rotate = (Math.random() * 14 - 7).toFixed(2);
                        noteElement.style.setProperty('--note-rotate', `${rotate}deg`);

                        const inner = document.createElement('div');
                        inner.className = 'note-inner';
                        inner.style.background = `linear-gradient(145deg, rgba(255,255,255,0.96), ${COLORS[index % COLORS.length]})`;

                        const title = document.createElement('div');
                        title.className = 'note-title';
                        title.textContent = 'LOVE NOTE';

                        const body = document.createElement('div');
                        body.className = 'note-body';
                        body.textContent = text;

                        inner.appendChild(title);
                        inner.appendChild(body);
                        noteElement.appendChild(inner);
                        layer.appendChild(noteElement);

                        requestAnimationFrame(() => {
                            noteElement.classList.add('visible');
                        });

                        notes.push({
                            el: noteElement,
                            target: heartPositions[index],
                        });
                    }, delay);
                });

                const mergeAt = NOTE_COUNT * CREATE_INTERVAL + HEART_DELAY_MS;
                setTimeout(() => {
                    notes.forEach((item, index) => {
                        const extraDelay = index * 12;
                        setTimeout(() => {
                            item.el.style.left = `${item.target.x}px`;
                            item.el.style.top = `${item.target.y}px`;
                            const softRotate = (Math.random() * 6 - 3).toFixed(2);
                            item.el.style.setProperty('--note-rotate', `${softRotate}deg`);
                        }, extraDelay);
                    });
                }, mergeAt);
            }

            window.addEventListener('load', createWall);
            window.addEventListener('resize', () => {
                createWall();
            });
        }());
    </script>
</body>
</html>

